{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport api from '../services/api';\nimport { Modal, Button } from 'react-bootstrap';\nconst Vision = () => {\n  _s();\n  // State for vision data\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [systemActive, setSystemActive] = useState(true);\n  const [cameraFeed, setCameraFeed] = useState(null);\n  const [detectionStats, setDetectionStats] = useState({\n    vehicles: 0,\n    pedestrians: 0,\n    traffic_signals: 0\n  });\n  const [incidents, setIncidents] = useState([]);\n\n  // Refs\n  const videoRef = useRef(null);\n\n  // Fetch vision data on component mount\n  useEffect(() => {\n    fetchVisionData();\n\n    // Set up periodic refresh\n    const interval = setInterval(fetchVisionData, 10000); // Refresh every 10 seconds\n\n    // Clean up interval on component unmount\n    return () => clearInterval(interval);\n  }, []);\n\n  // Function to fetch vision data\n  const fetchVisionData = async () => {\n    try {\n      setLoading(true);\n\n      // Fetch vision statistics\n      const statsResponse = await api.get('/vision/stats');\n\n      // Update detection stats\n      setDetectionStats({\n        vehicles: statsResponse.data.detection_counts.vehicle || 0,\n        pedestrians: statsResponse.data.detection_counts.pedestrian || 0,\n        traffic_signals: (statsResponse.data.detection_counts.traffic_light || 0) + (statsResponse.data.detection_counts.traffic_sign || 0)\n      });\n\n      // Fetch recent detections for incidents\n      const detectionsResponse = await api.get('/vision/detections');\n\n      // Filter for emergency incidents\n      const emergencyClasses = ['ambulance', 'police_car', 'fire_truck', 'maintenance_vehicle', 'accident', 'fire', 'smoke'];\n      const emergencyDetections = detectionsResponse.data.filter(detection => emergencyClasses.includes(detection.detection_type));\n      setLoading(false);\n    } catch (err) {\n      console.error('Error fetching vision data:', err);\n      setError('Failed to load vision data. Please try refreshing the page.');\n      setLoading(false);\n    }\n  };\n};\n_s(Vision, \"/0aPMwx7ZP+3Qh3NNqkrfcLZF28=\");\n_c = Vision;\nexport default Vision;\nvar _c;\n$RefreshReg$(_c, \"Vision\");","map":{"version":3,"names":["React","useState","useEffect","useRef","api","Modal","Button","Vision","_s","loading","setLoading","error","setError","systemActive","setSystemActive","cameraFeed","setCameraFeed","detectionStats","setDetectionStats","vehicles","pedestrians","traffic_signals","incidents","setIncidents","videoRef","fetchVisionData","interval","setInterval","clearInterval","statsResponse","get","data","detection_counts","vehicle","pedestrian","traffic_light","traffic_sign","detectionsResponse","emergencyClasses","emergencyDetections","filter","detection","includes","detection_type","err","console","_c","$RefreshReg$"],"sources":["/Users/sudipdas/Desktop/AST-test/frontend/src/pages/Vision.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport api from '../services/api';\nimport { Modal, Button } from 'react-bootstrap';\n\nconst Vision = () => {\n  // State for vision data\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [systemActive, setSystemActive] = useState(true);\n  const [cameraFeed, setCameraFeed] = useState(null);\n  const [detectionStats, setDetectionStats] = useState({\n    vehicles: 0,\n    pedestrians: 0,\n    traffic_signals: 0\n  });\n  const [incidents, setIncidents] = useState([]);\n  \n  // Refs\n  const videoRef = useRef(null);\n  \n  // Fetch vision data on component mount\n  useEffect(() => {\n    fetchVisionData();\n    \n    // Set up periodic refresh\n    const interval = setInterval(fetchVisionData, 10000); // Refresh every 10 seconds\n    \n    // Clean up interval on component unmount\n    return () => clearInterval(interval);\n  }, []);\n  \n  // Function to fetch vision data\n  const fetchVisionData = async () => {\n    try {\n      setLoading(true);\n      \n      // Fetch vision statistics\n      const statsResponse = await api.get('/vision/stats');\n      \n      // Update detection stats\n      setDetectionStats({\n        vehicles: statsResponse.data.detection_counts.vehicle || 0,\n        pedestrians: statsResponse.data.detection_counts.pedestrian || 0,\n        traffic_signals: (statsResponse.data.detection_counts.traffic_light || 0) + \n                        (statsResponse.data.detection_counts.traffic_sign || 0)\n      });\n      \n      // Fetch recent detections for incidents\n      const detectionsResponse = await api.get('/vision/detections');\n      \n      // Filter for emergency incidents\n      const emergencyClasses = ['ambulance', 'police_car', 'fire_truck', 'maintenance_vehicle', 'accident', 'fire', 'smoke'];\n      const emergencyDetections = detectionsResponse.data.filter(detection => \n        emergencyClasses.includes(detection.detection_type)\n      );\n      \n      \n      setLoading(false);\n    } catch (err) {\n      console.error('Error fetching vision data:', err);\n      setError('Failed to load vision data. Please try refreshing the page.');\n      setLoading(false);\n    }\n  };\n}; \nexport default Vision;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,OAAOC,GAAG,MAAM,iBAAiB;AACjC,SAASC,KAAK,EAAEC,MAAM,QAAQ,iBAAiB;AAE/C,MAAMC,MAAM,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACnB;EACA,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGT,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACU,KAAK,EAAEC,QAAQ,CAAC,GAAGX,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACY,YAAY,EAAEC,eAAe,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACc,UAAU,EAAEC,aAAa,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EAClD,MAAM,CAACgB,cAAc,EAAEC,iBAAiB,CAAC,GAAGjB,QAAQ,CAAC;IACnDkB,QAAQ,EAAE,CAAC;IACXC,WAAW,EAAE,CAAC;IACdC,eAAe,EAAE;EACnB,CAAC,CAAC;EACF,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGtB,QAAQ,CAAC,EAAE,CAAC;;EAE9C;EACA,MAAMuB,QAAQ,GAAGrB,MAAM,CAAC,IAAI,CAAC;;EAE7B;EACAD,SAAS,CAAC,MAAM;IACduB,eAAe,CAAC,CAAC;;IAEjB;IACA,MAAMC,QAAQ,GAAGC,WAAW,CAACF,eAAe,EAAE,KAAK,CAAC,CAAC,CAAC;;IAEtD;IACA,OAAO,MAAMG,aAAa,CAACF,QAAQ,CAAC;EACtC,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMD,eAAe,GAAG,MAAAA,CAAA,KAAY;IAClC,IAAI;MACFf,UAAU,CAAC,IAAI,CAAC;;MAEhB;MACA,MAAMmB,aAAa,GAAG,MAAMzB,GAAG,CAAC0B,GAAG,CAAC,eAAe,CAAC;;MAEpD;MACAZ,iBAAiB,CAAC;QAChBC,QAAQ,EAAEU,aAAa,CAACE,IAAI,CAACC,gBAAgB,CAACC,OAAO,IAAI,CAAC;QAC1Db,WAAW,EAAES,aAAa,CAACE,IAAI,CAACC,gBAAgB,CAACE,UAAU,IAAI,CAAC;QAChEb,eAAe,EAAE,CAACQ,aAAa,CAACE,IAAI,CAACC,gBAAgB,CAACG,aAAa,IAAI,CAAC,KACvDN,aAAa,CAACE,IAAI,CAACC,gBAAgB,CAACI,YAAY,IAAI,CAAC;MACxE,CAAC,CAAC;;MAEF;MACA,MAAMC,kBAAkB,GAAG,MAAMjC,GAAG,CAAC0B,GAAG,CAAC,oBAAoB,CAAC;;MAE9D;MACA,MAAMQ,gBAAgB,GAAG,CAAC,WAAW,EAAE,YAAY,EAAE,YAAY,EAAE,qBAAqB,EAAE,UAAU,EAAE,MAAM,EAAE,OAAO,CAAC;MACtH,MAAMC,mBAAmB,GAAGF,kBAAkB,CAACN,IAAI,CAACS,MAAM,CAACC,SAAS,IAClEH,gBAAgB,CAACI,QAAQ,CAACD,SAAS,CAACE,cAAc,CACpD,CAAC;MAGDjC,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC,CAAC,OAAOkC,GAAG,EAAE;MACZC,OAAO,CAAClC,KAAK,CAAC,6BAA6B,EAAEiC,GAAG,CAAC;MACjDhC,QAAQ,CAAC,6DAA6D,CAAC;MACvEF,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;AACH,CAAC;AAACF,EAAA,CA5DID,MAAM;AAAAuC,EAAA,GAANvC,MAAM;AA6DZ,eAAeA,MAAM;AAAC,IAAAuC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}